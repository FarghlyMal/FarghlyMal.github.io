---
title: "RedLine Stealer "
classes: wide
header:
  teaser: https://miro.medium.com/v2/resize:fit:1100/format:webp/1*pcrfeoKrqhdtk-T2wgH5oQ.jpeg
ribbon: DodgerBlue
description: "this in detailed analysis for Redline Stealer"
#categories:
  #- Malware Analysis
toc: true
---
# Introduction
Hello Geeks, today we will discuss How we get RedLine Stealer Artifacts, how to Extract its impact, and what it steals from your machine in a simple and straightforward way, keep Reading……

![](https://miro.medium.com/v2/resize:fit:875/1*pcrfeoKrqhdtk-T2wgH5oQ.jpeg)

# RedLine OverView

RedLine Stealer or RedLine is malware that can collect users’ confidential information and deliver other malicious programs. The availability and flexibility of the stealer cause financial loss, data leakage, targeting both enterprise and personal devices. Healthcare and manufacturing sectors suffer the most from these attacks.

The malware appeared in March 2020 according to the Proofpoint investigation. Since then RedLine has just gained steam. It was on the rise during the COVID-19 pandemic and is still active. On July 1st, 2021 the malware was found on the legit-looking website that provides privacy tools. However, based on the payload analysis, only malware can be found there.

# First Stage

The sample that we have deceives the user and shows him that it is legitimate and not harmful, and this is achieved through the large file size that reaches 1 megabyte, and this is a large file size compared to malicious programs in the wild

but if we take a look at the sample characteristics in PEStudio, we will find that 37 antivirus vendors detected it and that’s a big indicator of malicious activity also to complete its tricking behavior the sample has many resources like icons and images and strings table but unfortunately for the Malware Author these many resources give us an indicator of Dropping Activity like many other loaders

![](https://miro.medium.com/v2/resize:fit:875/1*v4HCuu3xyc3D066h_Hfr1A.png)

the 2 Resources referred to by the blue arrow give us an indicator to this tows may be decrypted and then loaded to memory via process injection or normal process Creation, so I will not waste my time in analyzing this stage I will use the debugger to dump the dropped sample, so we will but some breakpoints in sum suspicious APIs used to load Resources or Process Creation and trace its argument maybe we get something helpful

> [**_LoadResource()_**](https://learn.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadresource)
> 
> [**_CreateFileA()_**](https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-createfilea)
> 
> [**_WriteFile()_**](https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-writefile)
> 
> [**_CreateProcessA()_**](https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa)
> 
> [**_WriteProcessMemory()_**](https://learn.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-writeprocessmemory)

![](https://miro.medium.com/v2/resize:fit:875/1*EW4BVsOu923cUNX3t8ScxQ.png)

# Dropping Process

we got a big indicator of malicious activity that the file resolves a name from its resources Called | **tice0123.exe**

![](https://miro.medium.com/v2/resize:fit:875/1*yDlEJbasuYYZlZtVWUDDYw.png)

we will complete running the sample until we get something more,

so for the first time, we hit **CreateFileA**() which had been dynamically resolved due to **[call <F5A108> ]**Breakpoint we set before, and here are some arguments like file name that will be Created

> **_C:\Users\Hack\AppData\Local\Temp\IXP001.TMP\TMP4351$.TMP_**

![](https://miro.medium.com/v2/resize:fit:875/1*w8xQk7Dzm-bEJlRdYmWtRQ.png)

and here is the file

![](https://miro.medium.com/v2/resize:fit:875/1*cfqBtak3wUpvf1h94ywttA.png)

second Hit, with the file name to Create

> **_C:\Users\Hack\AppData\Local\Temp\IXP001.TMP\tice0123.exe_**

![](https://miro.medium.com/v2/resize:fit:875/1*6NDUjd7Ph21MzZiq8ogMPg.png)

![](https://miro.medium.com/v2/resize:fit:875/1*OqK3d--9O2CSNZJM5HMeUw.png)

Then We Hit WriteFileW which is used to Write Content in the File Created before, so we need to explore the data to be written and dump it which is referred to by **[ebp-c]**, so if we follow this in our dump that’s what we will get

![](https://miro.medium.com/v2/resize:fit:875/1*JDaQfc6k2s5d9FAY285dYg.png)

# The Same As Parent

WOW it’s a DoS Header for PEFile so we will dump it and not close our debugger we will just make a small basic analysis against this dropped file, it looks like the same loader but with no resources

![](https://miro.medium.com/v2/resize:fit:875/1*D845aRldp1FmJ_V-oi7nwA.png)

so we will not analyze it and will back to our Debugger and complete our breakpoints

it seems that the sample completed writing the resources in the dropped file, so we will skip this Sequential Writing Process

# Dropping Another Exe

so the sample starts by dropping another file called | **e779a32.exe**

> **_C:\Users\Hack\AppData\Local\Temp\IXP001.TMP\e779a32.exe_**

![](https://miro.medium.com/v2/resize:fit:875/1*JWq-STRAIJBSDKiFL58nJA.png)

we will analyze this sample and see if it deserves our attention or not, we take a look at it in PEstudio and we got something that affects the analysis process, the sample is a **[.NET]** programmed and it is flagged by 56 antivirus vendors as Malicuis Stealer so this dropped file that we will pay our attention to in the next words

![](https://miro.medium.com/v2/resize:fit:875/1*C9AKdPYyawFxcQ9-1TG_ow.png)

# **Real Sample Analysis**

for the next steps, we will use **Dnspy** to view the pseudocode of the sample, and here is the main of the sample

![](https://miro.medium.com/v2/resize:fit:875/1*IxSJ9lJRClLErxIu8l_jAg.png)

Entry Point

# Avoid infection

the sample starts by calling **WriteLine()** function which is in the same class, and then it first calls **EnveronmentChecker.Check(),** let’s explore this function.

the function used to avoid infection in some countries, so if your pc is in one of them, feel happy that you will never be infected by **REDLINE**

![](https://miro.medium.com/v2/resize:fit:875/1*uiOzzOm94N64hsBBNCxXFQ.png)

so it returns true if the pc is in one of these countries and then it will exit

![](https://miro.medium.com/v2/resize:fit:758/1*kP0SyiF51vPnXk4A176yOQ.png)

# C2 Dashboard

then it decrypts its **C2 IP address using its** own function that uses

a Base 64 encoding then it applies Xor operation with the key

> **_result= base64decode(input ^ key)_**

![](https://miro.medium.com/v2/resize:fit:875/1*twpWtzpYdYzCog6DGnC5nw.png)

so it will decrypt the IP address which is saved in a class called arguments that contain many arguments like
```C
public static string IP = "DjsYEykZChU+EFEKDixHECo3LF8+PSxC";  
  
  
 public static string ID = "IF0fWQcEflI=";  
  
  
 public static string Message = "";  
  
  
 public static string Key = "Cosies";  
  
  
 public static int Version = 1;
```
![](https://miro.medium.com/v2/resize:fit:875/1*2W5TZeB-qUDguUZsrKbxCg.png)

so this is the C2 IP address after decryption

> **_193.233.20.28:4125_**

![](https://miro.medium.com/v2/resize:fit:875/1*frHO202igMHJA_v1R2z0Ow.png)

then the malware tries to connect with C2 with this function using address resolved before on **port 4125**

![](https://miro.medium.com/v2/resize:fit:875/1*ceBfiADMfmB4xN2B3GAZBQ.png)

![](https://miro.medium.com/v2/resize:fit:875/1*T09WalR4RuFUyKtuTuzDHw.png)

and here is how the connection looks like in the Wireshark sniffing tool

![](https://miro.medium.com/v2/resize:fit:875/1*TMgfV16a5eUPd2S5TD9HIQ.png)

WOW, we watched that there are many packets with more than 3way hand-check which are used for session establishment, so if we follow TCP streams we will see that the malware pushes data to the agent in the victim machine.

![](https://miro.medium.com/v2/resize:fit:875/1*QXJqnzpWHgLcPLzvO694BA.png)

it’s another link, I think it will use it to download another thing let’s keep looking

![](https://miro.medium.com/v2/resize:fit:875/1*gN0MY0oAYuOinTXoYL8ZvA.png)

WOW, it’s the configuration file of the Agent which will be used to steal information from the machine, let’s see where it’s stored

![](https://miro.medium.com/v2/resize:fit:875/1*aRAd6BhNCFq2Vto1I7-lMA.png)

so all configuration is saved into Setting Object, it looks like this in memory

![](https://miro.medium.com/v2/resize:fit:875/1*6SNuC2K54AOrWMlUBAcffQ.png)

so to summarize the Connection with C2, the malware connect with c2 and then it asked for its configuration and saves it in an object called Settings which will be used as an argument to stealth functions

# Malware CORE

then it starts its normal stealing behavior using this function

![](https://miro.medium.com/v2/resize:fit:875/1*FfC5BCFdTKNW5ymjYvNmlg.png)

Based on this information, we could speculate that the purpose of the “Invoker” method might be to perform some operation or action using the provided connection and settings and return the result of that operation in the “Entity7” object. However, the exact details of what the method does and how it works depend on its implementation in the subclass, so it’s not possible to say for certain without more information, and this function has been **_Overided_** many times due to needs

![](https://miro.medium.com/v2/resize:fit:875/1*X9bl15iEilYjdhW6Rwwj-Q.png)

# GET Machine Public IP

→then it starts with identifying the IP address of the victim using [https://api.ip.sb/ip](http://bfnaelmomeimhlpmgjnjophhpkkoljpa|Phantom)

![](https://miro.medium.com/v2/resize:fit:875/1*UvnRvtIEXJe4yf6oCBmfUA.png)

# Checking Yandex

→then it gets this path related to the Yandex browser

> **_C:\Users\Hack\AppData\Local\Yandex\YaAddon_**

![](https://miro.medium.com/v2/resize:fit:875/1*rBtspqV_kafuCIP4LTla9g.png)

if the path is not found it will create this path

![](https://miro.medium.com/v2/resize:fit:875/1*hCe5Ba0gf6ejIF7CYQxHhA.png)

and then it will return false and guess it does this to check if the user is using a Russian browser and it will avoid infection

![](https://miro.medium.com/v2/resize:fit:875/1*qlz9uKqQ-nJjN0dp2xJ2Ng.png)

→ then it gets Display Size

![](https://miro.medium.com/v2/resize:fit:875/1*tzJ9wKn303BbUs7Jo_Iyqg.png)

→ then it gets Windows Version and Keyboard layout language

![](https://miro.medium.com/v2/resize:fit:875/1*XZs38SMliN24BzJPB-kVew.png)

![](https://miro.medium.com/v2/resize:fit:875/1*BahBlkR5bRAucu8ogL1_cw.png)

→ then it gets the username of the pc using APIS

![](https://miro.medium.com/v2/resize:fit:875/1*mYRhUZ9vXcN3U1YHXsd78g.png)

→ then it gets the Time Zone of the victim

![](https://miro.medium.com/v2/resize:fit:875/1*saH_eE0SSxo6IZtdY3uY1A.png)

# Get Process Path

→ then it gets its path of the running process using **GetExecutingAssembly()**

![](https://miro.medium.com/v2/resize:fit:875/1*RuKFBoL2XJgZ3Nk1VNLrVQ.png)

then it starts by getting the UserDomain Name, UserName, and Serial Number of windows and hashes them using MD5, and then saving in **result.Id1**

![](https://miro.medium.com/v2/resize:fit:875/1*TqlC6-SwnSvb2gXMrfNuYg.png)

→ before hashing

![](https://miro.medium.com/v2/resize:fit:875/1*ZhTMTi2UU6PoKqPjJYQb_Q.png)

→ after hashing

![](https://miro.medium.com/v2/resize:fit:875/1*D5JUnwqjccGEGEkFrx-F5g.png)

so if we want to summarize the data allocated which had been saved in a global List called **[result]** It will be as follows

> **_IP Address_**
> 
> **_Executable path_**
> 
> **_domain Name_**
> 
> **_Serial Number_**
> 
> **_UserName_**
> 
> **_Windows Version_**
> 
> **_Keyboard layout_**
> 
> **_Width,Height of Screen_**
> 
> **_Time Zone_**

![](https://miro.medium.com/v2/resize:fit:875/1*p1T1ngW0hg5xsprsl0L-yA.png)

# C2 Uploading

the malware after every time it collects data will send it to c2, in first, I think it allocates all data and then sends it all, but I was smart enough to watch suspicious behavior with Wireshark so I decided to follow streams in it, and what I get in the traffic after filtering with **IP address =193.233.20.28**

![](https://miro.medium.com/v2/resize:fit:875/1*vC2r7iTzmT-AHjMS_AGs8A.png)

so I trace to know what is the function responsible for this data streaming and I get a wonderful result

![](https://miro.medium.com/v2/resize:fit:875/1*KJ2htKaY3VxgZ8BAGKVbxA.png)

**So that we remain in agreement with the following lines, the malware every time it steals data it sends it immediately and I will give you how this packet looks like at the end of stealth behavior, keep reading.**

# - Search for Fils

**the sample is very tricky and the behavior ordering changed every time it restarts debugging process so the order of behavior will change maybe in your case, so in my case, it starts by searching files over some patterns in a user profile**

![](https://miro.medium.com/v2/resize:fit:875/1*_6zA2i8t9lgzl2vcd4oXrw.png)

here is the pattern

> **_%userprofile%\Desktop|*.txt,*.doc*,*key*,*wallet*,*seed*|0_**

so I create some files with the above extension to know what it s going to do with it

![](https://miro.medium.com/v2/resize:fit:830/1*_gmBhWzqF9esc1LY3Eojvg.png)

the malware will do some searches to reach one of these files

![](https://miro.medium.com/v2/resize:fit:836/1*-nn9RvZLEEsrzrigio2VXw.png)

so if we want to summarize all of the above that the malware searches for some patterns in specific files and return a list if it found any of them and then copies the data of these files in a list of bytes ……

> **_patterns → .doc | .txt | .wallet | .key | .seed_**
> 
> **_in_**
> 
> **_C:\Users\USERNAME\Desktop \_**
> 
> **_C:\Users\USERNAME\Documents\_**

and that is how the list looks like

> **_Id1 → file name_**
> 
> **_Id2 → file path_**
> 
> **_Id → file data in bytes representation_**

![](https://miro.medium.com/v2/resize:fit:875/1*AK8Gh9MSPYGy615ARW92uw.png)

# Get Hardware Info

the malware starts by allocating data of hardware capabilities like processor cores, ram size, graphics card vram size ..etc

![](https://miro.medium.com/v2/resize:fit:875/1*3u-XAD_ti_Nz7Jsj7tS3sA.png)

and here is how it looks like

> _the string in the figure refers to “Number Of cores”_

![](https://miro.medium.com/v2/resize:fit:875/1*WVegy3xbSIraBxbiXhuzwQ.png)

after iterating to get all processor's data it saves it all in one list and returns it

![](https://miro.medium.com/v2/resize:fit:875/1*MSPGNZtu3jmECeOF8qZudQ.png)

then the malware gets the Vram Size using the Management object and saves it in a list

![](https://miro.medium.com/v2/resize:fit:864/1*T_qAoLaEg8X2c8NNylqXOg.png)

and here how the list looks like

![](https://miro.medium.com/v2/resize:fit:875/1*Xe-qq1vsL_HUrkxbGzCXkw.png)

then the malware collects the size of the ram in MBs

![](https://miro.medium.com/v2/resize:fit:875/1*8IKNjW1YP_DP_gmb_mp2sA.png)

and return it in var called result, and here is how it looks like

![](https://miro.medium.com/v2/resize:fit:875/1*EUxeLJLL6RA7SjhGzxW8YQ.png)

and here is how all hardware info looks like after appending all of them in one list

![](https://miro.medium.com/v2/resize:fit:875/1*zfz-JYu9bDHEAWuubxdXpA.png)

# Stealing FTP Servers Data

the malware after the above behavior starts with stealing data related to FTP protocol using **FILEZILLA** product( Servers, ports, users ….stc), but first, it starts resolving files to be stolen, it resolves 2 file names that contain the data needed, and here is the code used in this operation
```C#
string path = string.Format(  
    new string(new char[]{'{','0','}','\\','F','i','l','e','Z','i','l','l','a','\\','r','e','c','e','n','t','s','e','r','v','e','r','s','.','x','m','l'}),  
    Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData));  
  
string path2 = string.Format(  
    new string(new char[]{'{','0','}','\\','F','i','l','e','Z','i','l','l','a','\\','s','i','t','e','m','a','n','a','g','e','r','.','x','m','l'}),  
    Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData));  
  
bool flag = File.Exists(path);  
if (flag)  
{  
    list.AddRange(Entity19.Id2(path));  
}  
  
bool flag2 = File.Exists(path2);  
if (flag2)  
{  
    list.AddRange(Entity19.Id2(path2));  
}

```
> `**_C:\Users\<username>\AppData\Roaming\Filezilla\recentservers.xml_**`

The `recentservers.xml` file is used by the FileZilla FTP client to store a list of recently used servers. This file is located in the user's application data directory and contains the connection details of the recently used servers, such as the server name, port number, username, and password. When a user opens the FileZilla FTP client, this file is read to display the list of recently used servers in the "Recent Servers" section of the application. This allows the user to quickly connect to a server they have recently used without having to re-enter all the connection details.

> **_C:\Users\{user}\AppData\Roaming\Filezilla\sitemanager.xml_**

This is the default path for the FileZilla FTP client’s sitemanager.xml file, which contains information about saved FTP server connections. The “{user}” portion of the path would be replaced with the username of the user account on the Windows operating system where FileZilla is installed.

so the process is that it checks if FileZilla is installed in the machine and it will steal data from the file explained above

![](https://miro.medium.com/v2/resize:fit:875/1*e5EejwLEnL90ZEk0EsOZNA.png)

so I have installed Filezilla and create a **server called Lol.com** with **ip=192.168.0.0** and **port=15523** with one username **called lol** and .**password = pass** … and all of this to not miss any behavior the malware will do

then the malware reads the data of these XML Files and saves it

![](https://miro.medium.com/v2/resize:fit:875/1*YPUtxHc0mG6RScyBarSeVg.png)

and here is how it checks and extracts data needed from the XML file

![](https://miro.medium.com/v2/resize:fit:830/1*--Xv-5pziPukexr8Km2AUA.png)

# Stealing browser Credentials

the malware starts its stealth behavior by copying login Data and Cookies from browsers Video Games Applications and Email Servers, and if we want to summarize what data the author wants to steal
```C#
List<string> list2 = FileCopier.FindPaths(baseDirectory, 1, 1, new string[]  
    {  
     "LEnvironmentogiEnvironmentn DatEnvironmenta".Replace("Environment", string.Empty),  
     "WSystem.Texteb DatSystem.Texta".Replace("System.Text", string.Empty),  
     "CoCryptographyokieCryptographys".Replace("Cryptography", string.Empty),  
     "ExtGenericension CooGenerickies".Replace("Generic", string.Empty)  
    });  
/* the output strings is   
"LoginData"  
"WEBData"  
"Cookies"  
"Extenstion Cookies"  
*/
```
> **_Login Data_**
> 
> **_Cookies_**
> 
> **_Exentision Cookies_**
> 
> **_Web Data_**

and here is the files that it steals from
```C
%USERPROFILE%\AppData\Local\Battle.net  
%USERPROFILE%\AppData\Local\Chromium\User Data  
%USERPROFILE%\AppData\Local\Google\Chrome\User Data  
%USERPROFILE%\AppData\Local\Google(x86)\Chrome\User Data  
%USERPROFILE%\AppData\Roaming\Opera Software\  
%USERPROFILE%\AppData\Local\MapleStudio\ChromePlus\User Data  
%USERPROFILE%\AppData\Local\Iridium\User Data  
%USERPROFILE%\AppData\Local\7Star\7Star\User Data  
%USERPROFILE%\AppData\Local\CentBrowser\User Data  
%USERPROFILE%\AppData\Local\Chedot\User Data  
%USERPROFILE%\AppData\Local\Vivaldi\User Data  
%USERPROFILE%\AppData\Local\Kometa\User Data  
%USERPROFILE%\AppData\Local\Elements Browser\User Data  
%USERPROFILE%\AppData\Local\Epic Privacy Browser\User Data  
%USERPROFILE%\AppData\Local\uCozMedia\Uran\User Data  
%USERPROFILE%\AppData\Local\Fenrir Inc\Sleipnir5\setting\modules\ChromiumViewer  
%USERPROFILE%\AppData\Local\CatalinaGroup\Citrio\User Data  
%USERPROFILE%\AppData\Local\Coowon\Coowon\User Data  
%USERPROFILE%\AppData\Local\liebao\User Data  
%USERPROFILE%\AppData\Local\QIP Surf\User Data  
%USERPROFILE%\AppData\Local\Orbitum\User Data  
%USERPROFILE%\AppData\Local\Comodo\Dragon\User Data  
%USERPROFILE%\AppData\Local\Amigo\User\User Data  
%USERPROFILE%\AppData\Local\Torch\User Data  
%USERPROFILE%\AppData\Local\Yandex\YandexBrowser\User Data  
%USERPROFILE%\AppData\Local\Comodo\User Data  
%USERPROFILE%\AppData\Local\360Browser\Browser\User Data  
%USERPROFILE%\AppData\Local\Maxthon3\User Data  
%USERPROFILE%\AppData\Local\K-Melon\User Data  
%USERPROFILE%\AppData\Local\Sputnik\Sputnik\User Data  
%USERPROFILE%\AppData\Local\Nichrome\User Data  
%USERPROFILE%\AppData\Local\CocCoc\Browser\User Data  
%USERPROFILE%\AppData\Local\Uran\User Data  
%USERPROFILE%\AppData\Local\Chromodo\User Data  
%USERPROFILE%\AppData\Local\Mail.Ru\Atom\User Data  
%USERPROFILE%\AppData\Local\BraveSoftware\Brave-Browser\User Data  
%USERPROFILE%\AppData\Local\Microsoft\Edge\User Data  
%USERPROFILE%\AppData\Local\NVIDIA Corporation\NVIDIA GeForce Experience  
%USERPROFILE%\AppData\Local\Steam  
%USERPROFILE%\AppData\Local\CryptoTab Browser\User Data
```
![](https://miro.medium.com/v2/resize:fit:844/1*JOm4ygLuvzzi8A8m8tSAgQ.png)

Files to Skip and don’t copy from it

> **_Windows  
> Program Files  
> Program Files (x86)  
> Program Data_**

![](https://miro.medium.com/v2/resize:fit:799/1*f_T8orOj_-H6L7L4rsxhMw.png)

so to summarize, the malware steals login data and cookies from browsers and other online Gaming Apps and saves all the data in a list that will be appended with other data to be sent to C2

let’s refer to how and where the data is saved

> **_Id1 → Application Name_**
> 
> **_Id2 → File in which we found data_**
> 
> **_Id3 → Saved Logins and passwords_**
> 
> **_Id4 → Cookies_**
> 
> **_Id5 → Extenstions_**
> 
> **_Id6 → browsers data like history and urls …etc_**

![](https://miro.medium.com/v2/resize:fit:875/1*7JfWm0GL5jM2W206-ITIqQ.png)

then the malware starts copying **[cookies.sqlite ]** databases from some browsers and Mail Servers

![](https://miro.medium.com/v2/resize:fit:875/1*GxiNxTtLvrNMTvB7inKAoA.png)

Folders to steal from
```C
%USERPROFILE%\AppData\Roaming\Mozilla\Firefox  
%USERPROFILE%\AppData\Roaming\Waterfox  
%USERPROFILE%\AppData\Roaming\K-Meleon  
%USERPROFILE%\AppData\Roaming\Thunderbird  
%USERPROFILE%\AppData\Roaming\Comodo\IceDragon  
%USERPROFILE%\AppData\Roaming\8pecxstudios\Cyberfox  
%USERPROFILE%\AppData\Roaming\NETGATE Technologies\BlackHaw  
%USERPROFILE%\AppData\Roaming\Moonchild Productions\Pale Moon
```
→ and using SQLReader it starts reading the data in this file

![](https://miro.medium.com/v2/resize:fit:875/1*RpDzxyMWklJ7JM5ti-bFSw.png)

and here is after finishing copying **Browsers Credintionls and Assets** it appends all data in one list explained before and also steals login data

![](https://miro.medium.com/v2/resize:fit:875/1*OktjgX8Fxmuxx2iHm-Ehnw.png)

# Take ScreenShots

then the malware starts its sniffing behavior by taking a screenshot of the current screen and saving it in the bitmap variable with compressed parameters to get a low size

![](https://miro.medium.com/v2/resize:fit:875/1*6O0B0a5jwYGykxs5itf53w.png)

# Steal Games Configuration

then the malware allocates some data related to Gaming and then sends it to C2

![](https://miro.medium.com/v2/resize:fit:875/1*h8dgsT9qrSGn3p62w38nPw.png)

# Steal VPN Cerdentieals

after all this stealth behavior the malware doesn't stop its bad habit which is of allocating data and then sending it, in this figure it searches for **NORDVPN** product which is a popular VPN agent

![](https://miro.medium.com/v2/resize:fit:650/1*QMGtT2X7oV67EGNPdBbTZA.png)

then if it found this EXE installed it start extracting some data from its XML file

![](https://miro.medium.com/v2/resize:fit:875/1*BDZGELeen8Aewo2yhpiZnw.png)

the malware then extracts some data like

> **_\\setting[@name=\\Username\\}/value_**
> 
> **_userConfig_**
> 
> **_setting[@name=\\password\\]/value_**

The string `setting[@name=\\password\\]/value` likely refers to a specific setting in a configuration or settings file that has a `name` attribute with the value of `password`, and a `value` attribute that contains the corresponding password value.

The double backslashes (`\\`) in the string are used to escape the backslash character. This is often done in computer programming to include special characters (such as backslashes) within a string literal. In this case, the string represents an XPath expression, which is often used to navigate and select elements within an XML document.

→ then it does the same but in this case, it’s about **OpenVPN** and **ProtonVPN** products and

![](https://miro.medium.com/v2/resize:fit:838/1*9fttZ63_3tbLjn6lkswfdg.png)

but unfortunately, I am not using any VPN products on this machine because it’s an analysis lab only

# Collecting Browsers Names

then the malware starts to get installed browser names in the victim’s machine by opening Registry Key related to the internet, then it opens the key and gets all the key on it, and save it in a string array called **subkeyNames**

![](https://miro.medium.com/v2/resize:fit:875/1*Tij8Mcx8z7BniZpJd8zqVw.png)

> **_HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Clients\StartMenuInternet_**

#### →This registry key stores information about the default internet browser installed on the computer, as well as other internet-related settings. The WOW6432Node portion of the path indicates that this key is located in the 32-bit portion of the registry on 64-bit versions of Windows…

and then it will open every subkey and get its value and also get a version of this browser, I think it allocates the version number to check its ability to be exploited or not, and also it gets the command used to run this browser using registry

![](https://miro.medium.com/v2/resize:fit:875/1*P2qyKRo8Mepur7NiR6OqDQ.png)

> **_SOFTWARE\Clients\StartMenuInternet[browser]\shell\open\command_**

→ this key saves the command used to run this browser, you can check it on your pc

so to summarize this this function allocate browsers data(Name,Version,Command Line) and save it in a list

![](https://miro.medium.com/v2/resize:fit:875/1*yVhXK8Q67oNNH8rVE9fd0g.png)

# Stealing Browser Wallets and Crypto Wallets

the malware completes its stealth behavior by starting to steal wallets credentials, and it starts this by decoding a string from base64

![](https://miro.medium.com/v2/resize:fit:875/1*kuIU8y1w2ax-CjlIeVV-NA.png)

we use [cyber chef](https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true,false)&input=Wm1adVltVnNabVJ2WldsdmFHVnVhMnBwWW01dFlXUnFhV1ZvYW1oaGFtSjhXVzl5YjJsWFlXeHNaWFFLYVdKdVpXcGtabXB0Yld0d1kyNXNjR1ZpYTJ4dGJtdHZaVzlwYUc5bVpXTjhWSEp2Ym14cGJtc0thbUprWVc5amJtVnBhV2x1YldwaWFteG5ZV3hvWTJWc1oySmxhbTF1YVdSOFRtbG1kSGxYWVd4c1pYUUtibXRpYVdobVltVnZaMkZsWVc5bGFHeGxabTVyYjJSaVpXWm5jR2RyYm01OFRXVjBZVzFoYzJzS1lXWmlZMkpxY0dKd1ptRmtiR3R0YUcxamJHaHJaV1Z2WkcxaGJXTm1iR044VFdGMGFGZGhiR3hsZEFwb2JtWmhibXR1YjJObVpXOW1ZbVJrWjJOcGFtNXRhRzVtYm10a2JtRmhaSHhEYjJsdVltRnpaUXBtYUdKdmFHbHRZV1ZzWW05b2NHcGlZbXhrWTI1blkyNWhjRzVrYjJScWNIeENhVzVoYm1ObFEyaGhhVzRLYjJSaVpuQmxaV2xvWkd0aWFXaHRiM0JyWW1wdGIyOXVabUZ1YkdKbVkyeDhRbkpoZG1WWFlXeHNaWFFLYUhCbmJHWm9aMlp1YUdKbmNHcGtaVzVxWjIxa1oyOWxhV0Z3Y0dGbWJHNThSM1ZoY21SaFYyRnNiR1YwQ21Kc2JtbGxhV2xtWm1KdmFXeHNhMjVxYm1Wd2IyZHFhR3RuYm05aGNHRmpmRVZ4ZFdGc1YyRnNiR1YwQ21OcVpXeG1jR3h3YkdWaVpHcHFaVzVzYkhCcVkySnNiV3ByWm1ObVptNWxmRXBoZUhoNFRHbGlaWEowZVFwbWFXaHJZV3RtYjJKcmJXdHFiMnB3WTJod1ptZGpiV2htYW01dGJtWndhWHhDYVhSQmNIQlhZV3hzWlhRS2EyNWpZMmhrYVdkdlltZG9aVzVpWW1Ga1pHOXFhbTV1WVc5blpuQndabXA4YVZkaGJHeGxkQXBoYld0dGFtcHRiV1pzWkdSdloyMW9jR3BzYjJsdGFYQmliMlp1Wm1wcGFIeFhiMjFpWVhRS1ptaHBiR0ZvWldsdFoyeHBaMjVrWkd0cVoyOW1hMk5pWjJWcmFHVnVZbWg4UVhSdmJXbGpWMkZzYkdWMENtNXNZbTF1Ym1scVkyNXNaV2RyYW1wd1kyWnFZMnh0WTJabloyWmxabVJ0ZkUxbGQwTjRDbTVoYm1wdFpHdHVhR3RwYm1sbWJtdG5aR05uWjJObWJtaGtZV0Z0YlcxcWZFZDFhV3hrVjJGc2JHVjBDbTVyWkdSbmJtTmthbWRxWm1Oa1pHRnRabWRqYldadWJHaGpZMjVwYldsbmZGTmhkSFZ5YmxkaGJHeGxkQXBtYm1wb2JXdG9hRzFyWW1wcmEyRmlibVJqYm01dloyRm5iMmRpYm1WbFkzeFNiMjVwYmxkaGJHeGxkQXBoYVdsbVltNWlabTlpY0cxbFpXdHBjR2hsWldscWFXMWtjRzVzY0dkd2NIeFVaWEp5WVZOMFlYUnBiMjRLWm01dVpXZHdhR3h2WW1wa2NHdG9aV05oY0d0cGFtcGthMmRqYW1ocmFXSjhTR0Z5Ylc5dWVWZGhiR3hsZEFwaFpXRmphR3R1YldWbWNHaGxjR05qYVc5dVltOXZhR05yYjI1dlpXVnRaM3hEYjJsdU9UaFhZV3hzWlhRS1kyZGxaVzlrY0daaFoycGpaV1ZtYVdWbWJHMWtabkJvY0d4clpXNXNabXQ4Vkc5dVEzSjVjM1JoYkFwd1pHRmthbXRtYTJkallXWm5ZbU5sYVcxamNHSnJZV3h1Wm01bGNHSnVhM3hMWVhKa2FXRkRhR0ZwYmdwaVptNWhaV3h0YjIxbGFXMW9iSEJ0WjJwdWFtOXdhR2h3YTJ0dmJHcHdZWHhRYUdGdWRHOXRDbVpvYVd4aGFHVnBiV2RzYVdkdVpHUnJhbWR2Wm10alltZGxhMmhsYm1Kb2ZFOTRlV2RsYmdwdFoyWm1hMlppYVdScGFHcHdiMkZ2YldGcWJHSm5ZMmhrWkd4cFkyZHdibnhRWVd4cFYyRnNiR1YwQ21GdlpHdHJZV2R1WVdSalltOWlabkJuWjJadWFtVnZibWRsYldwaWFtTmhmRUp2YkhSWUNtdHdabTl3YTJWc2JXRndZMjlwY0dWdFptVnVaRzFrWTJkb2JtVm5hVzF1ZkV4cGNYVmhiR2wwZVZkaGJHeGxkQXBvYldWdlltNW1ibVpqYldSclpHTnRiR0pzWjJGbmJXWndabUp2YVdWaFpueFlaR1ZtYVZkaGJHeGxkQXBzY0daalltcHJibWxxY0dWbGFXeHNhV1p1YTJscloyNWphV3RuWm1oa2IzeE9ZVzFwVjJGc2JHVjBDbVJ1WjIxc1lteGpiMlJtYjJKd1pIQmxZMkZoWkdkbVltTm5aMlpxWm01dGZFMWhhV0Z5UkdWR2FWZGhiR3hsZEFwbVptNWlaV3htWkc5bGFXOW9aVzVyYW1saWJtMWhaR3BwWldocWFHRnFZbnhaYjNKdmFWZGhiR3hsZEFwcFltNWxhbVJtYW0xdGEzQmpibXh3WldKcmJHMXVhMjlsYjJsb2IyWmxZM3hVY205dWJHbHVhd3BxWW1SaGIyTnVaV2xwYVc1dGFtSnFiR2RoYkdoalpXeG5ZbVZxYlc1cFpIeE9hV1owZVZkaGJHeGxkQXB1YTJKcGFHWmlaVzluWVdWaGIyVm9iR1ZtYm10dlpHSmxabWR3WjJ0dWJueE5aWFJoYldGemF3cGhabUpqWW1wd1luQm1ZV1JzYTIxb2JXTnNhR3RsWlc5a2JXRnRZMlpzWTN4TllYUm9WMkZzYkdWMENtaHVabUZ1YTI1dlkyWmxiMlppWkdSblkybHFibTFvYm1adWEyUnVZV0ZrZkVOdmFXNWlZWE5sQ21ab1ltOW9hVzFoWld4aWIyaHdhbUppYkdSamJtZGpibUZ3Ym1SdlpHcHdmRUpwYm1GdVkyVkRhR0ZwYmdwdlpHSm1jR1ZsYVdoa2EySnBhRzF2Y0d0aWFtMXZiMjVtWVc1c1ltWmpiSHhDY21GMlpWZGhiR3hsZEFwb2NHZHNabWhuWm01b1ltZHdhbVJsYm1wbmJXUm5iMlZwWVhCd1lXWnNibnhIZFdGeVpHRlhZV3hzWlhRS1lteHVhV1ZwYVdabVltOXBiR3hyYm1wdVpYQnZaMnBvYTJkdWIyRndZV044UlhGMVlXeFhZV3hzWlhRS1kycGxiR1p3YkhCc1pXSmthbXBsYm14c2NHcGpZbXh0YW10bVkyWm1ibVY4U21GNGVIaE1hV0psY25SNUNtWnBhR3RoYTJadlltdHRhMnB2YW5CamFIQm1aMk50YUdacWJtMXVabkJwZkVKcGRFRndjRmRoYkd4bGRBcHJibU5qYUdScFoyOWlaMmhsYm1KaVlXUmtiMnBxYm01aGIyZG1jSEJtYW54cFYyRnNiR1YwQ21GdGEyMXFhbTF0Wm14a1pHOW5iV2h3YW14dmFXMXBjR0p2Wm01bWFtbG9mRmR2YldKaGRBcG1hR2xzWVdobGFXMW5iR2xuYm1Sa2EycG5iMlpyWTJKblpXdG9aVzVpYUh4QmRHOXRhV05YWVd4c1pYUUtibXhpYlc1dWFXcGpibXhsWjJ0cWFuQmpabXBqYkcxalptZG5abVZtWkcxOFRXVjNRM2dLYm1GdWFtMWthMjVvYTJsdWFXWnVhMmRrWTJkblkyWnVhR1JoWVcxdGJXcDhSM1ZwYkdSWFlXeHNaWFFLYm10a1pHZHVZMlJxWjJwbVkyUmtZVzFtWjJOdFptNXNhR05qYm1sdGFXZDhVMkYwZFhKdVYyRnNiR1YwQ21adWFtaHRhMmhvYld0aWFtdHJZV0p1WkdOdWJtOW5ZV2R2WjJKdVpXVmpmRkp2Ym1sdVYyRnNiR1YwQ21GcGFXWmlibUptYjJKd2JXVmxhMmx3YUdWbGFXcHBiV1J3Ym14d1ozQndmRlJsY25KaFUzUmhkR2x2YmdwbWJtNWxaM0JvYkc5aWFtUndhMmhsWTJGd2EybHFhbVJyWjJOcWFHdHBZbnhJWVhKdGIyNTVWMkZzYkdWMENtRmxZV05vYTI1dFpXWndhR1Z3WTJOcGIyNWliMjlvWTJ0dmJtOWxaVzFuZkVOdmFXNDVPRmRoYkd4bGRBcGpaMlZsYjJSd1ptRm5hbU5sWldacFpXWnNiV1JtY0dod2JHdGxibXhtYTN4VWIyNURjbmx6ZEdGc0NuQmtZV1JxYTJacloyTmhabWRpWTJWcGJXTndZbXRoYkc1bWJtVndZbTVyZkV0aGNtUnBZVU5vWVdsdUNtSm1ibUZsYkcxdmJXVnBiV2hzY0cxbmFtNXFiM0JvYUhCcmEyOXNhbkJoZkZCb1lXNTBiMjBLWm1ocGJHRm9aV2x0WjJ4cFoyNWtaR3RxWjI5bWEyTmlaMlZyYUdWdVltaDhUM2g1WjJWdUNtMW5abVpyWm1KcFpHbG9hbkJ2WVc5dFlXcHNZbWRqYUdSa2JHbGpaM0J1ZkZCaGJHbFhZV3hzWlhRS1lXOWthMnRoWjI1aFpHTmliMkptY0dkblptNXFaVzl1WjJWdGFtSnFZMkY4UW05c2RGZ0thM0JtYjNCclpXeHRZWEJqYjJsd1pXMW1aVzVrYldSaloyaHVaV2RwYlc1OFRHbHhkV0ZzYVhSNVYyRnNiR1YwQ21odFpXOWlibVp1Wm1OdFpHdGtZMjFzWW14bllXZHRabkJtWW05cFpXRm1mRmhrWldacFYyRnNiR1YwQ214d1ptTmlhbXR1YVdwd1pXVnBiR3hwWm01cmFXdG5ibU5wYTJkbWFHUnZmRTVoYldsWFlXeHNaWFFLWkc1bmJXeGliR052WkdadlluQmtjR1ZqWVdGa1oyWmlZMmRuWm1wbWJtMThUV0ZwWVhKRVpVWnBWMkZzYkdWMENtSm9aMmh2WVcxaGNHTmtjR0p2YUhCb2FXZHZiMjloWkdScGJuQnJZbUZwZkVGMWRHaGxiblJwWTJGMGIzSUtiMjlyYW14aWEybHBhbWx1YUhCdGJtcG1abU52Wm1wdmJtSm1ZbWRoYjJOOFZHVnRjR3hsVjJGc2JHVjA) to decode this string and here is the output
```C
ffnbelfdoeiohenkjibnmadjiehjhajb|YoroiWallet  
ibnejdfjmmkpcnlpebklmnkoeoihofec|Tronlink  
jbdaocneiiinmjbjlgalhcelgbejmnid|NiftyWallet  
nkbihfbeogaeaoehlefnkodbefgpgknn|Metamask  
afbcbjpbpfadlkmhmclhkeeodmamcflc|MathWallet  
hnfanknocfeofbddgcijnmhnfnkdnaad|Coinbase  
fhbohimaelbohpjbbldcngcnapndodjp|BinanceChain  
odbfpeeihdkbihmopkbjmoonfanlbfcl|BraveWallet  
hpglfhgfnhbgpjdenjgmdgoeiappafln|GuardaWallet  
blnieiiffboillknjnepogjhkgnoapac|EqualWallet  
cjelfplplebdjjenllpjcblmjkfcffne|JaxxxLiberty  
fihkakfobkmkjojpchpfgcmhfjnmnfpi|BitAppWallet  
kncchdigobghenbbaddojjnnaogfppfj|iWallet  
amkmjjmmflddogmhpjloimipbofnfjih|Wombat  
fhilaheimglignddkjgofkcbgekhenbh|AtomicWallet  
nlbmnnijcnlegkjjpcfjclmcfggfefdm|MewCx  
nanjmdknhkinifnkgdcggcfnhdaammmj|GuildWallet  
nkddgncdjgjfcddamfgcmfnlhccnimig|SaturnWallet  
fnjhmkhhmkbjkkabndcnnogagogbneec|RoninWallet  
aiifbnbfobpmeekipheeijimdpnlpgpp|TerraStation  
fnnegphlobjdpkhecapkijjdkgcjhkib|HarmonyWallet  
aeachknmefphepccionboohckonoeemg|Coin98Wallet  
cgeeodpfagjceefieflmdfphplkenlfk|TonCrystal  
pdadjkfkgcafgbceimcpbkalnfnepbnk|KardiaChain  
bfnaelmomeimhlpmgjnjophhpkkoljpa|Phantom  
fhilaheimglignddkjgofkcbgekhenbh|Oxygen  
mgffkfbidihjpoaomajlbgchddlicgpn|PaliWallet  
aodkkagnadcbobfpggfnjeongemjbjca|BoltX  
kpfopkelmapcoipemfendmdcghnegimn|LiqualityWallet  
hmeobnfnfcmdkdcmlblgagmfpfboieaf|XdefiWallet  
lpfcbjknijpeeillifnkikgncikgfhdo|NamiWallet  
dngmlblcodfobpdpecaadgfbcggfjfnm|MaiarDeFiWallet  
ffnbelfdoeiohenkjibnmadjiehjhajb|YoroiWallet  
ibnejdfjmmkpcnlpebklmnkoeoihofec|Tronlink  
jbdaocneiiinmjbjlgalhcelgbejmnid|NiftyWallet  
nkbihfbeogaeaoehlefnkodbefgpgknn|Metamask  
afbcbjpbpfadlkmhmclhkeeodmamcflc|MathWallet  
hnfanknocfeofbddgcijnmhnfnkdnaad|Coinbase  
fhbohimaelbohpjbbldcngcnapndodjp|BinanceChain  
odbfpeeihdkbihmopkbjmoonfanlbfcl|BraveWallet  
hpglfhgfnhbgpjdenjgmdgoeiappafln|GuardaWallet  
blnieiiffboillknjnepogjhkgnoapac|EqualWallet  
cjelfplplebdjjenllpjcblmjkfcffne|JaxxxLiberty  
fihkakfobkmkjojpchpfgcmhfjnmnfpi|BitAppWallet  
kncchdigobghenbbaddojjnnaogfppfj|iWallet  
amkmjjmmflddogmhpjloimipbofnfjih|Wombat  
fhilaheimglignddkjgofkcbgekhenbh|AtomicWallet  
nlbmnnijcnlegkjjpcfjclmcfggfefdm|MewCx  
nanjmdknhkinifnkgdcggcfnhdaammmj|GuildWallet  
nkddgncdjgjfcddamfgcmfnlhccnimig|SaturnWallet  
fnjhmkhhmkbjkkabndcnnogagogbneec|RoninWallet  
aiifbnbfobpmeekipheeijimdpnlpgpp|TerraStation  
fnnegphlobjdpkhecapkijjdkgcjhkib|HarmonyWallet  
aeachknmefphepccionboohckonoeemg|Coin98Wallet  
cgeeodpfagjceefieflmdfphplkenlfk|TonCrystal  
pdadjkfkgcafgbceimcpbkalnfnepbnk|KardiaChain  
bfnaelmomeimhlpmgjnjophhpkkoljpa|Phantom  
fhilaheimglignddkjgofkcbgekhenbh|Oxygen  
mgffkfbidihjpoaomajlbgchddlicgpn|PaliWallet  
aodkkagnadcbobfpggfnjeongemjbjca|BoltX  
kpfopkelmapcoipemfendmdcghnegimn|LiqualityWallet  
hmeobnfnfcmdkdcmlblgagmfpfboieaf|XdefiWallet  
lpfcbjknijpeeillifnkikgncikgfhdo|NamiWallet  
dngmlblcodfobpdpecaadgfbcggfjfnm|MaiarDeFiWallet  
bhghoamapcdpbohphigoooaddinpkbai|Authenticator  
ookjlbkiijinhpmnjffcofjonbfbgaoc|TempleWallet
```
it’s a collection of online wallets and an unknown string, I really do not know anything about this string but it may be something related to cryptography …..

after resolving names it starts to search for these wallets in the file system and browser's directories and then it searches for Crypto Currencies also which are saved in Local Var Called **Setting.Id13**

![](https://miro.medium.com/v2/resize:fit:875/1*3avdMaW5DFztbfz-_RE7vQ.png)

and if it found it, it will read its configuration and resolve all data then send it to C2 using Connection Class

![](https://miro.medium.com/v2/resize:fit:834/1*pogTVj7hKCTYVxmtmfREqQ.png)

# Collect Available languages

the malware also collects available language collected before

![](https://miro.medium.com/v2/resize:fit:875/1*JiqjO7tvNBMGBmZOh_DuiA.png)

# Get Security Products

then the malware starts to get Antivirus products and firewalls and also to get victim defense weapons and guns

> **_AntiVirus | Anti SpyWare | FireWall_**

the author tries to get all names of any product installed in this machine from the above Security products Using **Management Object Searcher using ChatGpt to learn about this object we got a wonderful result**

The code uses the `ManagementObjectSearcher` class from the `System.Management` namespace to search for objects related to system security in the WMI (Windows Management Instrumentation) repository. The search is performed based on the query string `SELECT * FROM SecurityCenter` concatenated with the `str` variable.

![](https://miro.medium.com/v2/resize:fit:875/1*7hBS0cVjgRT2vr-bmxyeOw.png)

cause this is a lab machine, I don’t have any defense mechanism so the list of the products will be null…

# Get a List of Installed Programs

the malware starts to get all installed binaries in the machine by using a registry that had been used before to get browsers in pc, and then malware opens the key

> **_SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall_**

and get all installed program using a subkey called **| DisplayName|** here is how this operation look like

![](https://miro.medium.com/v2/resize:fit:875/1*i-dg4q714GzwabM9oMFFow.png)

# **Get A List Of All running Processes**

the malware also allocate name of all running process and send them to C2 to identify what kind of Victim Machine is

![](https://miro.medium.com/v2/resize:fit:858/1*c0pirMU9digbUlcOq-5gtQ.png)

the author uses Management Object Collection to do this operation

> **_resolved text → SELECT * FROM Win_32Process Where SessionId=””_**

![](https://miro.medium.com/v2/resize:fit:875/1*LEhxssjwMq8Pck1XJVvKag.png)

and this is the data allocated

> **_Process Name_**
> 
> **_ID_**
> 
> **_CommandLine_**

and here is how our list looks like after allocation

![](https://miro.medium.com/v2/resize:fit:875/1*ijxfaYaZZ0emrMxmvny_GA.png)

# Stealing Discord Tokens

the sample will start searching for Discord File in System and then will steal tokens

![](https://miro.medium.com/v2/resize:fit:875/1*uLYAk9w0Z4KBS3KYuNC_tQ.png)

after ending all the stealth behavior in function **LSIDds2**

![](https://miro.medium.com/v2/resize:fit:875/1*1i4ORcbkfSNwV_EDQka_Yw.png)

the malware will try to sleep for a second. if the connection with C2 failed and then will reconnect to it and here the Malware ends its functionality

so if we want to summarize the stolen Credentials and information and map it with the function it did this stealth it will be like this
```
вашу0л34         --> Sereaches for .docx  & .txt & .wallet & .key & .seed           in  Desktop and Documents Folders  
вал93тфыв        --> Copy logins and Cookies from Browsers   
asdk9345asd      --> allocate  hardware info and capabilities   
навева           --> steal FTP Data(host,port,users,passwords)  
askd435          --> steal data related to gaming(Steam)  
asdasod9234oasd  --> steal VPN credentials  
asdk8jasd        --> allocate all browsers products  
ащы9р34          --> steal online wallets  
ываш9р34         --> collect available language   
аловй            --> get Antivirus products and firewalls   
ылв92р34выа      --> get a list of all programs installed   
ыал8р45          --> get a list of a running process   
длвап9345        --> take Screen Shots   
ыва83о4тфыв      --> steal Discord Tokens
```
if you remember what I told you about TCP Stream and how the packet looks like at the end of stealing

![](https://miro.medium.com/v2/resize:fit:875/1*s9yKmV6CLAcn_4G-KFpfRA.png)

**!!! do not do this in your private machine use an isolated machine to not be stolen**

# TTPs

I used chatgpt for mapping between behavior and som ttps
```js
Behavior: Searches for .docx, .txt, .wallet, .key, .seed files in Desktop and Documents folders.  
  
Tactic: Discovery  
  
Technique:  
  
    File and Directory Discovery (T1083)

Behavior: The malware copies login credentials and cookies from web browsers.  
  
Tactic: Credential Access  
  
Technique:  
  
    Input Capture (T1056)  
    Credential Dumping (T1003)

Behavior: The malware is attempting to gather information about  
           the hardware and capabilities of the system.  
  
Tactic: Discovery  
  
Technique:  
  
    System Information Discovery (T1082)  
    System Network Connections Discovery (T1049)

Behavior: The malware uses TCP to push data to a command and control (C2) server.  
  
Tactic: Command and Control  
  
Technique:  
  
    Network Communication Through Removable Media (T1025)  
    Standard Application Layer Protocol (T1071)  
    Data Encoding (T1132)  
    Data Obfuscation (T1001)

Behavior: The malware steals cryptocurrency wallets.  
  
Tactic: Collection  
  
Technique:  
  
    Data from Local System (T1005)

Behavior: The malware is attempting to get information about antivirus products and firewalls on the system.  
  
Tactic: Discovery  
  
Technique:  
  
    System Information Discovery (T1082)  
    Security Software Discovery (T1063)  
    Process Discovery (T1057)

Behavior: The malware uses the registry to dump data.  
  
Tactic: Collection  
  
Technique:  
  
    Registry Run Keys / Start Folder (T1060)  
    Data from Local System (T1005)  
    Remote System Discovery (T1018)
```
# **IOCs**
```python
Hashes:   
       Stage1  
          md5    --> 28F41A382B8D204A11287484A8140C20  
          sha1   --> 5E79C6549E69BAE844726A6CFDF2A76F408A2DED  
          sha256 --> F25DF69F7FD6F922C90CBACBFEF48C8D6BD5E36706724D37B5FA7AA1AD9FA593  
       Stage2  
          md5    --> 795F3FE5687DB9B19853EAF6ACDC389A  
          sha1   --> CD1BA862909C58A01D3A8E44C29CB71BB6B50630  
          sha256 --> 448BAD37914CB6F2102C2C8B10CD93770E529AB4FD13E616EE99E2E184CB0E56  
File:  
          C:\Users\Hack\AppData\Local\Temp\IXP000.TMP\e779a32.exe  
          C:\Users\Hack\AppData\Local\Temp\IXP000.TMP\tice123.exe  
        
Network:  
          net.tcp://193.233.20.28:4125/ 
```
```python
rule Redline  
{  
    meta :  
        Discription = "rule for detecting Redline info stealer (unpacked)"  
        Author      =  "Aziz Farghly"  
   
  Strings:  
       $mz = {4D 5A}  
       $S1 = "Cosies"  
       $S2 = "DjsYEykZChU+EFEKDixHECo3LF8+PSxC"  
       $S3 = "net.tcp://"  
       $S4 = "UNKNOWN"  
       $S5 = "Environment"  
       $S6 = "Cryptography"  
       $S7 = "CoCryptographyokieCryptographys"  
       $S8 = " Extension"  
       $S9 = "System.Text.RegularExpressions"  
       $S10= "shell\\open\\command"  
       $S11= "SELESystem.ManagementCT * FRSystem.ManagementOM"  
  
Conditions:  
       ($mz at 0) and $S2 or $S3 or(4 of ($S*))  
  
}
```
**_In the end, I explained what I was able to do, even if there were any mistakes. Do not hesitate to tell me so that I can learn from my mistakes. I hope that the article has benefited you._**

**_join us for learning:_**

> [_Malware Analysts FaceBook Private Group_](https://www.facebook.com/groups/HalalGroup4Hacking)
> 
> [_Malware Analysts Telegram Private Group_](https://t.me/MalwareAnalysts)

— — — — — — — — - -< اللهم لك الحمد دائما وابدا> — — — — — — — -
